# 命令
Visual Studio Code中，命令触发操作。如果您曾[配置过快捷键](https://code.visualstudio.com/docs/getstarted/keybindings)，那么您已经使用了命令。命令同样被扩展用于展现功能给用户，绑定操作到VS Code UI和实现内部逻辑
## 使用命令
VS Code包含了一大套您可以用来与编辑器交互、控制用户界面或执行后台操作的[内建命令](/9.%20%E6%9F%A5%E9%98%85/5.%20%E5%86%85%E5%BB%BA%E5%91%BD%E4%BB%A4.md)。许多扩展同样展现它们的核心功能作为用户与其他扩展能够使用的命令
### 编程执行一条命令
[`vscode.commands.executeCommand`](/9.%20%E6%9F%A5%E9%98%85/1.%20VS%20Code%20API.md#commands)API编程执行一条命令。这让您使用VS Code内建功能，并以扩展为基础构建如VS Code内建Git和Markdown扩展

例如`editor.action.addCommentLine`命令，在启用文本编辑器中注释当前行：
```typescript
import * as vscode from 'vscode';

function commentLine() {
    vscode.commands.executeCommand('editor.action.addCommentLine');
}
```
一些命令需要参数控制行为。命令同样可能返回一个结果。API如`vscode.executeDefinitionProvider`命令，在指定位置查询文档中的定义。它需要一个文档URI和一个位置作为参数，并返回一列定义答复：
```typescript
import * as vscode from 'vscode';

async function printDefinitionsForActiveEditor() {
  const activeEditor = vscode.window.activeTextEditor;
  if (!activeEditor) {
    return;
  }

  const definitions = await vscode.commands.executeCommand<vscode.Location[]>(
    'vscode.executeDefinitionProvider',
    activeEditor.document.uri,
    activeEditor.selection.active
  );

  for (const definition of definitions) {
    console.log(definition);
  }
}
```
寻找可用的命令：
- [浏览键盘快捷键](https://code.visualstudio.com/docs/getstarted/keybindings)
- [仔细查看VS Code内建高级命令API](/9.%20%E6%9F%A5%E9%98%85/5.%20%E5%86%85%E5%BB%BA%E5%91%BD%E4%BB%A4.md)
### 命令URI
命令URI是执行给定命令的链接。它们可以作为在悬停文本上作为可点击链接、补全项详情或网络视图内使用

一个命令URI使用`command`方案后跟命令名。例如`editor.action.addCommentLine`命令URI是`command:editor.action.addCommentLine`。这里是一个在可用文本编辑器当前行注释展示链接悬停提供器
```typescript
import * as vscode from 'vscode';

export function activate(context: vscode.ExtensionContext) {
  vscode.languages.registerHoverProvider(
    'javascript',
    new (class implements vscode.HoverProvider {
      provideHover(
        _document: vscode.TextDocument,
        _position: vscode.Position,
        _token  : vscode.CancellationToken
      ): vscode.ProviderResult<vscode.Hover> {
        const commentCommandUri = vscode.Uri.parse(`command:editor.action.addCommentLine`);
        const contents = new vscode.MarkdownString(`[Add comment](${commentCommandUri})`);

        // 为了在Markdown内容中启用命令URI，您必须设置`isTrusted`标志
        // 在创建信任的Markdown字符串时，确认正确地清理
        // 输入内容以便只有期望的命令URI执行
        contents.isTrusted = true;

        return new vscode.Hover(contents);
      }
    })()
  );
}
```
命令参数列表作为正确URI编码的JSON数组传递：下面的示例使用`git.stage`命令创建一个使当前文件出现的悬停链接：
```typescript
import * as vscode from 'vscode';

export function activate(context: vscode.ExtensionContext) {
  vscode.languages.registerHoverProvider(
    'javascript',
    new (class implements vscode.HoverProvider {
      provideHover(
        document: vscode.TextDocument,
        _position: vscode.Position,
        _token: vscode.CancellationToken
      ): vscode.ProviderResult<vscode.Hover> {
        const args = [{ resourceUri: document.uri }];
        const stageCommandUri = vscode.Uri.parse(
          `command:git.stage?${encodeURIComponent(JSON.stringify(args))}`
        );
        const contents = new vscode.MarkdownString(`[Stage file](${stageCommandUri})`);
        contents.isTrusted = true;
        return new vscode.Hover(contents);
      }
    })()
  );
}
```
当网络视图被创建时，您可以在[网络视图](7.%20%E7%BD%91%E7%BB%9C%E8%A7%86%E5%9B%BE.md)中通过在`WebviewOptions`设置`enableCommandUris`启用命令URI
## 创建命令
### 注册一个命令
[`vscode.commands.registerCommand`]在您的扩展中绑定命令ID到一个处理程序函数
```typescript
import * as vscode from 'vscode';

export function activate(context: vscode.ExtensionContext) {
  const command = 'myExtension.sayHello';

  const commandHandler = (name: string = 'world') => {
    console.log(`Hello ${name}!!!`);
  };

  context.subscriptions.push(vscode.commands.registerCommand(command, commandHandler));
}
```