# VS Code在AI方面的可扩展性
本文提供了Visual Studio Code AI的扩展选择概览，帮助您的扩展选择正确的趋势。

VS Code包含可增强编程体验的强大AI功能：
- **代码补全**：在输入时提供行间代码建议
- **代理模式**：使用特殊工具使AI能够自主规划执行开发任务
- **聊天**：让开发者使用自然语言在聊天界面中，询问有关代码库问题或者对代码库作出编辑
- **智能操作**：处理常见开发任务时使用融合在整个编辑器的AI增强操作

你可以扩展和自定义这些内建功能来创建贴合您的用户特殊需求的定制AI体验。

## 为什么在VS Code里扩展AI

在您的扩展中添加AI功能为您的用户带来一些好处：
- **代理模式下特定领域的知识**：让代理模式访问您公司的数据源和服务
- **增强用户体验**：在您的扩展中提供定制的智能辅助
- **领域专业化**：创建应用于特定编程语言、框架或者领域的AI
- **扩展聊天功能**：在聊天界面中添加特殊工具或者助手带来更强大的互动
- **改良开发者生产力**：使用AI功能推动常规开发者的任务，如调试、代码检查或者测试

## 扩展聊天体验
### 语言模型工具
语言模型工具允许您在VS Code中扩展特定领域能力的代理模式。在代理模式，这些工具基于用户聊天提示词自动调用，并执行特定任务或者从数据源和服务中检索信息。用户也可以明确地在他们的聊天提示词中使用#提及工具引用这些工具。

要实现一个语言模型工具，在您的VS Code扩展中使用[语言模型工具API](/4.%20扩展指南/2.%20AI.md#工具)。语言模型工具可以访问所有的VS Code扩展API，并进一步融入编辑器。

**重要优势**：
- 作为自动编程工作流一部分的专业领域能力
- 您的工具实现可以使用VS Code API，因为它运行在扩展宿主进程
- 在Visual Studio市场中轻易地分发部署

**注意事项**：
- 远程部署需要扩展实现客户端-服务端交流
- 不同工具间的重复利用需要模块化设计和实现

### MCP工具

模型上下文协议（MCP）工具通过使用标准化协议，提供了将外部服务和语言模型的方式。在代理模式，这些工具基于用户聊天提示词自动调用，来处理专业化的任务或者在外部数据源中检索信息。

MCP工具在VS Code外部运行，要么在用户的机器本地运行，或者作为一项远程服务。用户可以通过JSON配置MCP工具，或者让VS Code扩展编程配置他们。你可以通过各种语言SDK和部署选择实现MCP工具。

因为MCP工具在VS Code外部运行，他们无法访问VS Code扩展API。

**重要优势**：
- 作为自动编程工作流一部分的专业领域能力
- 本地远程部署选择
- 在其他MCP客户端重复利用MCP服务端

**注意事项**：
- 无法访问VS Code扩展API
- 分发部署需要用户设置MCP服务器
### 聊天参与者
聊天参与者是允许用户扩展咨询特定领域专家的方式的专业助手。在聊天中，用户可以通过用@提及它唤起聊天参与者，并传递关于特定主题或者领域的自然语言提示词。聊天参与者将负责处理整个聊天互动。

为了实现聊天参与者，在您的VS Code扩展中使用[聊天API](#聊天)。聊天参与者可以访问所有VS Code扩展API，并更加深入融入编辑器。

**重要优势**
- 控制端对端互动流
- 运行在扩展宿主进程中，可以访问VS Code扩展API
- 在Visual Studio市场中轻易分发部署

**注意事项**：
- 远程部署需要扩展实现客户端-服务端交流
- 在不同工具间重复利用需要模块化设计和实现

## 构建您自己的AI赋能特性
为了创建您扩展中自定义的AI赋能特性，VS Code允许您通过编程访问AI模型。这个方法让您能够构建针对编辑器互动的AI能力，而不依赖于聊天界面。

为了直接使用语言模型，在您的VS Code扩展中使用[语言API](#语言模型)。您可以在任何扩展特性中包含这些AI能力，比如代码操作，悬停提供者，自定义视图和其他。

**关键特性**：
- 整合AI能力到已有的扩展特性或构建一个新的。
- 在扩展宿主进程中允许访问VS Code扩展API。
- 通过Visual Studio市场简单的分发和部署

**特别注意：**
- 跨部分的重复利用需要模块化设计和实现

## 作出决定

当在您的VS Code扩展中选择扩展AI的正确方式时，考虑以下指导：
1. 在下面情况选择语言模型工具：
    - 您应该在VS Code中扩展具有特定功能的聊天
    - 您应该在代理模式下基于用户专注的自动化调用
    - 您应该在VS Code中为了深度融合允许访问API
    - 您应该通过VS Code市场分发您的工具
2. 在下面情况选择MCP工具：
    - 您应该在VS Code中扩展具有特定功能的聊天
    - 您应该在代理模式下基于用户专注的自动化调用
    - 您不需要整合VS Code API
    - 您的工具需要在不同环境下工作（不仅仅是VS Code）
    - 您的工具需要远程或本地运行
3. 在下面情况选择聊天参与者：
    - 您应该同通过定制具有该领域专业能力的助手扩展询问模式
    - 您应该自定义整个互动流和反应行为
    - 您应该为了深度融合访问VS Code API
    - 您应该通过VS Code市场分发
4. 在下面情况选择语言模型API
    - 您想要在现有的扩展特性中整合AI能力
    - 您想要在聊天界面之外构建UI体验
    - 您想要直接编程控制AI模型请求

## 下一步
选择最适合您扩展目标的方法：

- [实现语言模型工具]
- [在您的VS Code扩展中注册MCP工具]
- [在语言模型API中整合AI]
- [实现聊天参与者]
- [在行间补全API中扩展AI补全]

## 示例项目 
- [聊天示例](https://github.com/microsoft/vscode-extension-samples/tree/main/chat-sample)：具有代理模式工具和聊天参与者的扩展
- [代码教练聊天参与者教程]：构建定制化聊天助手
- [AI赋能代码注解教程]：手把手教你使用语言模型API
- [MCP扩展示例](https://github.com/microsoft/vscode-extension-samples/tree/main/mcp-extension-sample)：注册MCP工具的扩展
# 语言模型工具API
语言模型工具允许您扩展聊天中大语言模型（LLM）的大部分功能。VSCode中的[代理](https://code.visualstudio.com/docs/copilot/chat/copilot-chat)可以自动调用这些工具，处置聊天当中的特殊任务来用户的聊天提示词。

通过在VS Code扩展中贡献语言模型工具，您可以在扩展代理编程工作流的同时，提供更深层次与编辑器的融合。扩展工具与[内建工具和MCP工具](https://code.visualstudio.com/docs/copilot/chat/chat-tools#_types-of-tools)是三种可用工具类型。

在这篇扩展指南，您可以学习如何通过是使用语言模型工具API创建语言模型工具，和如何实现在聊天扩展中调用的工具。

您也可以通过贡献[MCP服务端](#MCP开发者指南)使用特殊工具扩展聊天体验。关于不同选择和如何确定方法的详情参见[API扩展概述](#vs-code在ai方面的可扩展性)。

> 提示
> 作为终端用户获取更多使用工具的信息，参见[在聊天中使用工具](https://code.visualstudio.com/docs/copilot/chat/chat-tools)

## 什么工具叫做LLM
语言模型工具是可以作为语言模型请求一部分调用的函数。例如，您可能有一个函数，它在数据库中检索信息，处理计算或者调用在线API。当你在VS Code扩展中贡献工具时，代理模式可以在那时基于聊天上下文调用工具。

LLM从不实际执行工具自身，而是生成用于调用工具的参数。清楚描述工具的目的、功能和输入参数是重要的，这样才能让工具可以在正确的上下文被调用。

下面的图示展示了代理模式下的工具调用流。关于涉及的具体步骤详情参见[工具调用流程](#语言模型工具api)。

![](https://code.visualstudio.com/assets/api/extension-guides/ai/tools/copilot-tool-calling-flow.png)

在OpenAI文档中阅读更多有关[函数调用](https://platform.openai.com/docs/guides/function-calling)